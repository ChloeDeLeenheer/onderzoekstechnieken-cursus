\chapter{Analyse op 1 variabele}
\label{ch:analyse1var}

%% TODO: volgorde van centrum-/ spreidingsmaten eens bekijken en overzichtelijker maken.

\begin{definition}[Beschrijvende statistiek]
  Met beschrijvende statistiek \index{beschrijvende statistiek} bedoelen we een verzameling van technieken om data synthetisch voor te stellen en samen te vatten.
\end{definition}

\section{Voorbeeld met superhelden}
\begin{table}
  \centering
  \begin{tabular}{|c|c|c|c|c|}
    \hline
    $x_{1}$ & $x_{2}$ & $x_{3}$ & $x_{4}$&  $x_{5}$ \\
    \hline
    141 & 198 & 143 & 201 & 184 \\
    \hline
  \end{tabular}
  \caption{Voorbeeldtabel superhelden vanuit slides}
  \label{tab:helden}
\end{table}

\section{Gemiddelde}
\begin{definition}[Gemiddelde]
  \index{Gemiddelde} Het gemiddelde (symbool $\mu$) van een set waarden is de som van al deze waarden gedeeld door het aantal waarden. De formule staat beschreven in \ref{eq:Mean}.
  \begin{equation}
    \mu = \frac{1}{n} \times \sum_{i=1}^{n} x_{i}
    \label{eq:Mean}
  \end{equation}

  Waarbij:
  \begin{itemize}
    \item $x_{i}$ de waarden zijn vanuit tabel \ref{tab:helden}.
    \item $n$ het aantal waarden is. In het voorbeeld van de superhelden zou dit 5 zijn, want we hebben 5 lengtes van superhelden.
  \end{itemize}
\end{definition}


\begin{exercise}
  Wat is de gemiddelde lengte van de superhelden?
\end{exercise}

\begin{exercise}
  Vraag: het gemiddelde van 15 cijfers is 12. Welk nummer moeten
  we aan de rij van cijfers toevoegen om een gemiddelde van 13 te bekomen?
\end{exercise}

Het rekenkundig gemiddelde is gevoelig aan outliers: een extreme waarde kan het rekenkundig gemiddelde zwaar be\"invloeden.

\section{Mediaan}

\begin{definition}[Mediaan]
  Indien we alle cijfers sorteren van klein naar groot, is de \index{Mediaan} mediaan het middelste cijfer, of het gemiddelde van de twee middelste cijfers indien het aantal cijfers even is.
\end{definition}

De mediaan is niet gevoelig aan outliers.

\section{Modus}
\begin{definition}[Modus]
  De \index{Modus} modus is het cijfer dat het meest voorkomt in een set van cijfers.
\end{definition}

\begin{itemize}
  \item Heeft niet veel zin als alle cijfers even veel voorkomen. (Zoals bij onze superhelden). Misschien is het nuttig om ze dan te groeperen.
  \item Er kunnen twee modi zijn: dit noemen we \index{Bimodaal} bimodaal;
  \item Er kunnen meerdere modi zijn: dit noemen we \index{Multimodaal} multimodaal.
\end{itemize}

\begin{example}
  Het groeperen kunnen we tonen bijvoorbeeld bij het aantal mensen gered door Batman de laatste acht jaar.
  \begin{itemize}
    \item $[0-9]$ mensen : 4, 7
    \item $[10-19]$ mensen: 11, 16
    \item $[20-29]$ mensen : 20, 22, 25, 26
    \item $[30-39]$ mensen: 33
  \end{itemize}
  Dus categorie $[20-29]$ komt het meest voor. We kunnen dus bv. kiezen om 25 als modus te gebruiken. Zo'n klasse noemen we dan een modale klasse.
\end{example}

\section{Range / Bereik}
\begin{definition}[Bereik]
  Het \index{Range} \index{Bereik} bereik in een set van getallen is de absolute waarde van het verschil tussen het laagste en grootste getal.
\end{definition}

\section{Kwartielen \& kwartielafstand}
\begin{definition}[Kwartielen \& Kwartielafstand]
  De \index{Kwartiel} kwartielen zijn de waarden die een gesorteerde lijst van nummers in 4 gelijke delen deelt. Elk deel vormt dus een kwart van de dataset. Men spreekt van een eerste, tweede en derde kwartiel ($Q_{1}$, $Q_{2}$, $Q_{3}$).
\end{definition}

Dus:
\begin{itemize}
  \item eerste kwartiel $Q_{1}$ is de getalswaarde die de laagste 25 \% van de reeks afscheidt.
  \item tweede kwartiel $Q_{2}$ is de getalwaarde die de laagste 50\% van de reeks afscheidt.
  \item derde kwartiel $Q_{3}$ is de getalwaarde die de laagste 75\% van de reeks afscheidt.
\end{itemize}

\begin{definition}
  \index{Kwartielafstand} Kwartielafstand is het verschil tussen $Q_{3}$ en $Q_{1}$ ( dus $Q_{3} - Q_{1}$).
\end{definition}

Methode om te berekenen (volgens \textcite{Moore2002}) (met $n$ oneven aantal getallen):
\begin{itemize}
  \item $Q_{1}$ komt overeen met cijfer $\frac{n+1}{4}$
  \item $Q_{3}$ komt overeen met cijfer $\frac{3n+3}{4}$
\end{itemize}

Methode om te berekenen (met $n$ even aantal getallen):
\begin{itemize}
  \item $Q_{1}$ komt overeen met cijfer $\frac{n+2}{4}$
  \item $Q_{3}$ komt overeen met cijfer $\frac{3n+2}{4}$
\end{itemize}

\begin{exercise}
  Met welke voorgaande statistiek komt $Q_{2}$ overeen?
\end{exercise}

\section{Variantie en standaardafwijking}
\label{sec:varEnSD}
\begin{definition}[Variantie]
  De \index{Variantie} variantie (symbool $\sigma^{2}$ - lees sigma kwadraat) is het gemiddelde van de kwadraten van de verschillen tussen de waarde van de dataset en het gemiddelde.
  \begin{equation}
    \sigma^{2} = \frac{1}{n} \times \sum_{i=1}^{n} \left( \mu - x_i \right)^{2}
    \label{eq:variantie}
  \end{equation}
\end{definition}


\begin{example}
  De variantie bij de lengtes van onze superhelden wordt als volgt berekend:

  \begin{equation}
    \begin{aligned}
      \sigma^{2} &=  \frac{(173.4-141)^{2} + (173.4 - 198 )^{2} + (173.4 - 143)^{2} + (173.4- 201)^{2} + (173.4  -184 )^{2}}{5} \\
      &=  \frac{(-32.4)^{2}+	(24.6)^{2}	+ (-30.4)^{2}+	(27.6)^{2}	+ (10.6)^{2}}{5}\\
      &= \frac{1049.76 + 	605.16	 + 924.16	 + 761.76 + 	112.36}{5}\\
      &= \frac{3453.2}{5} = 690.64
    \end{aligned}
  \end{equation}
\end{example}

\begin{definition}[Standaardafwijking]
  De \index{Standaardafwijking} standaardafwijking wordt dan gedefinieerd als de vierkantswortel van de variantie.
  \begin{equation}
    \sigma = \sqrt{\sigma^{2}}
    \label{eq:stdev}
  \end{equation}
\end{definition}


Dit geeft ons dus inzicht in wat normaal is en wat abnormaal is: een kleine standaardafwijking wijst erop dat de waarden dicht bij de centrummaat ($\mu$) liggen, terwijl een grote standaardafwijking duidt dat de waarden verspreid liggen over een groot bereik van waarden. In sommige gevallen wil men een grote standaardafwijking, in andere gevallen niet zoals hieronder beschreven.

\begin{example}
  Bij het vervaardigen van een schroevendraaier is de grootte van de kop belangrijk voor het goed functioneren van de schroevendraaier. Als we dus van 100 verschillende schroevendraaiers de kopgrootte meten, is het beter dat die grootte redelijk constant is en wensen we dus een kleine standaardafwijking.
\end{example}

\begin{example}
  Bij het onderzoek naar onze superhelden, wensen we te weten hoeveel ze ongeveer verdienen in hun normale job. We hebben een aantal rijke superhelden (bv. Batman) en een aantal minder rijke superhelden (bv. Spiderman). De spreiding op hun inkomen is dus groot, maar dat is niet per definitie slecht.
\end{example}


Een aangename eigenschap van de standaardafwijking is dat het uitgedrukt kan worden in dezelfde metriek als de gemeten data. Bij ons voorbeeld van de superhelden, wil dat zeggen dat de standaardafwijking 26.28 cm is.

Zoals het gemiddelde is de variantie en de standaarddeviatie gevoelig aan outliers (uitschieters). De variantie is eigenlijk gevoeliger dan het gemiddelde. Inderdaad, voor een outlier is de afstand tot het gemiddelde kleiner dan het kwadraat van deze afstand.

\section[Centrum- en spreidingsmaten toepassen]{Toepassing spreidingsmaten en maten centraliteit op verschillende soorten variabelen}

\begin{table}
  \centering
  \begin{tabular}{|l|l|l|l|l|}
    \hline
    \textbf{Analyse} & \textbf{Nominaal} & \textbf{Ordinaal} & \textbf{Interval} of \textbf{Ratio} \\
    \hline
    \textbf{Centrum} & Modus & Mediaan & Gemiddelde \\
    & Modale klasse & Modus & Mediaan \\
    & & Modale klasse & Modale klasse \\
    \hline
    \textbf{Spreiding} & & Range & Range \\
    & & Interkwartielafstand & Interkwartielafstand \\
    & & & Standaarddeviatie \\
    \hline
  \end{tabular}
  \caption{Meetniveaus en mogelijkheden op variabelen}
  \label{tab:Meetniveaus}
\end{table}

\section{Grafieken}

\subsection{Boxplot}

De \index{Boxplot} boxplot wordt gevormd door een rechthoek begrensd door de kwartielwaarden (25\% en 75\%). In deze rechthoek wordt ook de mediaan getekend. De stelen, die aan de rechthoek zitten, bevatten de rest van de waarnemingen op de uitschieters en extremen na.

\begin{itemize}
  \item Een \index{Uitschieter} uitschieter is een waarde die meer dan 1.5 keer de interkwartielafstand boven/onder het derde/eerste kwartiel ligt. Wordt aangeduid met een cirkeltje.
  \item Een \index{Extremum} extremum is een waarde die meer dan 3 keer de interkwartielafstand boven/onder het derde/eerste kwartiel ligt. Wordt aangeduid met een sterretje.
\end{itemize}

\section{R}
Zodra u een vector (of een lijst met nummers) in het geheugen hebt, zijn de meeste basiswerkingen beschikbaar. De meeste basiswerkzaamheden werken op een hele vector en kunnen gebruikt worden om snel een groot aantal berekeningen uit te voeren met een enkele opdracht. Indien je een operatie uitvoert op meerdere vectoren, is het vaak nodig dat de vectoren allemaal hetzelfde aantal elementen bevatten.

Hieronder zie je een set van eenvoudige operaties die je met vectoren kan doen. Let op dat de operaties allemaal op een element per element basis uitgevoerd worden. 
\lstinputlisting{data/operaties.R}

De volgende commando's kunnen worden gebruikt om het gemiddelde,de kwartielen, het  minimum, het maximum, de variantie en  de standaardafwijking van een reeks getallen te verkrijgen.

\lstinputlisting{data/basics.R}

\section{Oefeningen}

\subsection{Centrum- en spreidingsmaten}

\begin{definition}
	Een frequentietabel is tabel waarin de frequenties van een waarde staan die in de volledige dataset voorkomt. Meestal zijn de tabellen verticaal georiÃ«nteerd.
\end{definition}

\begin{exercise}
  De formule voor standaardafwijking en variatie staan beschreven in sectie \ref{sec:varEnSD}. Hoe moet de formule aangepast worden om $\sigma$ en $\sigma^{2}$ te berekenen wanneer we te maken hebben met een frequentietabel? Doe dit voor de data in tabel \ref{tab:pinfreq}.
\end{exercise}

	\begin{table}
		\centering
		\caption{Aantal pinnen met frequentie}
		\label{tab:pinfreq}
		\begin{tabular}{@{}ll@{}}
			\toprule
			Pinnen $x$ & Frequentie $f_{x}$ \\ \midrule
			0          & 2                  \\
			1          & 1                  \\
			2          & 2                  \\
			3          & 0                  \\
			4          & 2                  \\
			5          & 4                  \\
			6          & 9                  \\
			7          & 11                 \\
			8          & 13                 \\
			9          & 8                  \\ \midrule
			10         & 8                  \\ \bottomrule
		\end{tabular}
	\end{table}
	
\begin{exercise}
In de formule voor de variantie  wordt het verschil tussen de meetpunten en het gemiddelde gekwadrateerd. Waarom? Zoek dit uit door volgende berekenigswijzen eens uit te proberen.

\[ \sigma^{2}_{1} = \frac{1}{n} \sum_{i=1}^{n} (\mu - x) \]
\[ \sigma^{2}_{2} = \frac{1}{n} \sum_{i=1}^{n} \left| \mu - x\right| \]
\[ \sigma^{2}_{3} = \frac{1}{n} \sum_{i=1}^{n} (\mu - x)^{2} \]

Dataset X \[ \left\{ 4,4,-4,-4 \right\} \]
Dataset Y \[ \left\{ 7,1,-6,-2 \right\} \]
\end{exercise}

\begin{exercise}
Zoek eens zelfstandig op wat de variatieco\"effici\"ent is. Hoe
wordt die gedefinieerd voor een volledige populatie en wat zou
je ermee kunnen doen?
\end{exercise}

\begin{exercise}
Beschouw de volgende subsets uit het data frame \texttt{ais} (uit de library DAAG):
\begin{enumerate}
\item Ontleed de gegevens voor de roeiers.
\item Ontleed de gegevens voor de roeiers, de netballers en de tennissers.
\item Ontleed de gegevens voor de de vrouwelijke basketballers en roeiers.
\end{enumerate}
\end{exercise}

\begin{exercise}
Gebruik de functies \texttt{mean}  en \texttt{range} om het gemiddelde en bereik van:
\begin{itemize}
  \item de cijfers 1, 2, \dots, 21 
  \item 50 willekeurige normale waarden, die  worden gegenereerd vanuit een normale distributie met gemiddelde 0 en variantie 1
  \item de kolommen \texttt{height} en \texttt{weight} in de data frame \texttt{women} (standaard in R).
\end{itemize}
\end{exercise}

In vorige oefeningen hebben we de verschillende spreidingsmaten en centrummaten besproken. Zoals je merkt worden deze metrieken ook gebruikt in het onderzoek van~\textcite{Akin2016}. In de volgende oefeningen gaan we trachten de resultaten te reproduceren.

Hiervoor hebben we het bestand \texttt{android\_persistence\_cpu.csv} nodig. Je vindt die in de Github-repository van deze cursus, onder directory \texttt{oefeningen/data/oef\_3\_1variabele}

\begin{exercise}
  \label{oef:casus-akin2016-1var}
	Open de file met excel en bekijk de structuur van het document. Hoe ziet die er uit? Kan je de variabelen identificeren en hun type benoemen. 
\end{exercise}

We gaan het programma \texttt{R} gebruiken samen met \texttt{RStudio}. Open de file in \texttt{RStudio}.

\begin{lstlisting}
android_cpu <-  read.csv("android_persistence_cpu.csv", sep=";", dec=",")
attach(android_cpu)
\end{lstlisting}

We hebben nu de data ingeladen. We kunnen eens kijken wat de gemiddelde tijd, de standaarddeviatie, de kwartielen e.a. zijn. Gebruik hiervoor de commando's \texttt{mean}, \texttt{median}, \texttt{quantile}, \texttt{min}, \texttt{max}, \texttt{var}, \texttt{sd}. Je kan ook makkelijk gebruik maken van de methode \texttt{summary}.

\begin{exercise}
	Als je de vorige metrieken berekend hebt, wat kan je daar dan over zeggen. Kan je zinnige conclusies trekken uit de vorige resultaten. Zo ja vermeld ze, zo nee beschrijf waarom je dat denkt.
\end{exercise}

\subsection{Grafieken in R}

Een histogram is een eenvoudige plot. het toont de frequenties van de data die in een bepaald bereik voorkomen. 

\begin{lstlisting}
hist(android_cpu$Tijd,main="Verdeling van de tijd",xlab="De gemeten cpu tijd");
hist(android_cpu$Tijd,main="Verdeling van de tijd",xlab="De gemeten cpu tijd",breaks=2);
\end{lstlisting}
\begin{exercise}
	Wat concludeer je als je bovenstaande grafiek\footnote{Heb je wat problemen met het genereren van grafieken, volgende link \url{https://www.datacamp.com/community/tutorials/15-questions-about-r-plots\#gs.RK_ORsI} bevat een aantal goede tips and tricks om je op weg te helpen.} genereert? Is dit een zinnig resultaat? Wat gebeurt er als je de variabele breaks verhoogt?
\end{exercise}

Een boxplot toont de mediaan, de kwartielen, het maximum en het minimum van een dataset. Dit geeft ons een duidelijk impressie van hoe de data er uitziet.

\begin{lstlisting}
boxplot(x = android_cpu$Tijd);
boxplot(android_cpu$Tijd,main='Spreiding van de CPU tijd',ylab='Tijd in ms');
\end{lstlisting} 

\begin{exercise}
	De boxplot wordt standaard verticaal getekend. Gebruik het commando \texttt{help(boxplot)} om uit te zoeken hoe we de tekening horizontaal krijgen. 
\end{exercise}

Als je goed geantwoord hebt op de volgende vragen merk je natuurlijk dat het weinig zin heeft de volledige dataset te analyseren, aangezien de dataset verdeeld is over verschillende categorie\"en. We willen dus wel deze statistieken weten, maar per categorie. We kunnen zus een boxplot maken voor elke categorie.

\begin{lstlisting}
boxplot(android_cpu$Tijd~android_cpu$Datahoeveelheid,main='Spreiding van de CPU tijd t.o.v. datahoeveelheid',ylab='Tijd in ms');
\end{lstlisting}

\begin{exercise}
	\label{ex:boxplot}
	Interpreteer de resultaten die je behaalt uit deze grafiek. Zijn deze al wat zinniger?
\end{exercise}

We kunnen hetzelfde doen voor de verschillende soorten dataopslagmogelijkheden in android.

\begin{exercise}
	Zelfde vraag als \ref{ex:boxplot} Interpreteer de resultaten die je behaalt uit deze grafiek. Zijn deze al wat zinniger?
\end{exercise}

We kunnen eens kijken hoe de data eruit ziet over alle categorie\"en heen.

\begin{lstlisting}
boxplot(android_cpu$Tijd~android_cpu$PersistentieType*android_cpu$Datahoeveelheid,main='Spreiding van de CPU tijd',ylab='Tijd in ms');
\end{lstlisting}

Het blijkt dat we wel al een duidelijker zicht krijgen over de data over de categorie\"en heen, maar de figuur is op dit moment te druk. 

We moeten de data dus onderverdelen in categorie\"en namelijk onder \texttt{PersistentieType} en \texttt{Datahoeveelheid}. We gaan hiervoor de functie \texttt{which}\footnote{Je kan ook gebruik maken van de functie \texttt{subset}, wat misschien zelfs eenvoudiger is} gebruiken en kijken hoe de verschillende datahoeveelheden verschillen per datahoeveelheidcategorie. 

\begin{lstlisting}
greenDOA <- android_cpu[which(android_cpu$PersistentieType=='GreenDAO'),];
boxplot(greenDOA$Tijd~greenDOA$Datahoeveelheid);
\end{lstlisting}

\begin{exercise}
	Wat concludeer je uit de vorige grafiek?
\end{exercise}

\begin{exercise}
	Ga nu zelf na welke boxplots er interessant zijn om te maken, en kijken of jouw resultaten overeen met die van \textcite{Akin2016}. Welke conclusies trek je?
\end{exercise}





